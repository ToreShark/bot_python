# smart_handler.py
from telebot import types

class SmartHandler:
    """Ð£Ð¼Ð½Ñ‹Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹"""
    
    def __init__(self, bot):
        self.bot = bot
        
        # Ð¡Ð»Ð¾Ð²Ð°Ñ€ÑŒ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ñ… ÑÐ»Ð¾Ð² - Ñ‡Ñ‚Ð¾ Ð¸Ñ‰ÐµÐ¼ Ð² ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑÑ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹
        self.keywords = {
            'Ð±Ð°Ð½ÐºÑ€Ð¾Ñ‚ÑÑ‚Ð²Ð¾': [
                'Ð±Ð°Ð½ÐºÑ€Ð¾Ñ‚ÑÑ‚Ð²Ð¾', 'Ð±Ð°Ð½ÐºÑ€Ð¾Ñ‚', 'Ð´Ð¾Ð»Ð³Ð¸', 'Ð´Ð¾Ð»Ð³', 'ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'Ð·Ð°Ð¹Ð¼', 
                'Ð¿Ñ€Ð¾ÑÑ€Ð¾Ñ‡ÐºÐ°', 'Ð½Ðµ Ð¼Ð¾Ð³Ñƒ Ð¿Ð»Ð°Ñ‚Ð¸Ñ‚ÑŒ', 'Ð½ÐµÑ‚ Ð´ÐµÐ½ÐµÐ³', 'Ð¿Ñ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ð°',
                'Ð²Ð½ÐµÑÑƒÐ´ÐµÐ±Ð½Ð¾Ðµ', 'ÑÑƒÐ´ÐµÐ±Ð½Ð¾Ðµ'
            ],
            'Ð¾Ñ‚Ñ‡ÐµÑ‚': [
                'ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚', 'Ð¾Ñ‚Ñ‡ÐµÑ‚', 'Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ', 'Ð°Ð½Ð°Ð»Ð¸Ð·', 'ÐŸÐšÐ‘', 'Ð“ÐšÐ‘',
                'ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ', 'ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð°Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ'
            ],
            'ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ': [
                'ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ', 'Ð²Ð¾Ð¿Ñ€Ð¾Ñ', 'Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ', 'ÑÐ¾Ð²ÐµÑ‚', 'ÑŽÑ€Ð¸ÑÑ‚', 'Ð°Ð´Ð²Ð¾ÐºÐ°Ñ‚',
                'ÐºÐ°Ðº Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ', 'Ñ‡Ñ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ'
            ]
        }

    def analyze_message(self, text):
        """ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ - Ð¾ Ñ‡ÐµÐ¼ Ð¾Ð½ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚?"""
        text_lower = text.lower()  # ÐŸÐµÑ€ÐµÐ²Ð¾Ð´Ð¸Ð¼ Ð² Ð½Ð¸Ð¶Ð½Ð¸Ð¹ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€
        
        # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÐºÐ°Ð¶Ð´ÑƒÑŽ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ
        for category, keywords in self.keywords.items():
            for keyword in keywords:
                if keyword in text_lower:
                    return category  # Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½ÑƒÑŽ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ
        
        return 'Ð¾Ð±Ñ‰ÐµÐµ'  # Ð•ÑÐ»Ð¸ Ð½Ð¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ð½Ð°ÑˆÐ»Ð¸

    def create_response(self, category):
        """Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¾Ñ‚Ð²ÐµÑ‚ Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ñ‚Ð¾Ð³Ð¾, Ð¾ Ñ‡ÐµÐ¼ ÑÐ¿Ñ€Ð¾ÑÐ¸Ð» Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ"""
        
        if category == 'Ð±Ð°Ð½ÐºÑ€Ð¾Ñ‚ÑÑ‚Ð²Ð¾':
            text = (
                "ðŸ¤– Ð’Ð¸Ð¶Ñƒ, Ñ‡Ñ‚Ð¾ Ð²Ð°Ñ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÑƒÐµÑ‚ **Ð±Ð°Ð½ÐºÑ€Ð¾Ñ‚ÑÑ‚Ð²Ð¾**!\n\n"
                "ðŸ“‹ **Ð¯ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼:**\n\n"
                "âš–ï¸ **ÐŸÑ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð°Ñ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ** (Ð¿Ð»Ð°Ñ‚Ð½Ð¾)\n"
                "â€¢ ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ñ‹Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ Ð¿Ð¾ Ð·Ð°ÐºÐ¾Ð½Ð¾Ð´Ð°Ñ‚ÐµÐ»ÑŒÑÑ‚Ð²Ñƒ Ð Ðš\n"
                "â€¢ ÐÐ½Ð°Ð»Ð¸Ð· Ð²Ð°ÑˆÐµÐ¹ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð¹ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ð¸\n\n"
                "ðŸ“… **Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð°Ñ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ Ñ Ð°Ð´Ð²Ð¾ÐºÐ°Ñ‚Ð¾Ð¼**\n"
                "â€¢ ÐŸÑ€ÑÐ¼Ð¾Ðµ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ñ ÐœÑƒÑ…Ñ‚Ð°Ñ€Ð¾Ð²Ñ‹Ð¼ Ð¢Ð¾Ñ€ÐµÑ…Ð°Ð½\n"
                "â€¢ ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð¿Ð¾Ð½ÐµÐ´ÐµÐ»ÑŒÐ½Ð¸Ðº, 14:00-17:00\n\n"
                "ðŸ§® **Ð‘Ð°Ð½ÐºÑ€Ð¾Ñ‚Ð½Ñ‹Ð¹ ÐºÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€** (Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾)\n"
                "â€¢ ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ Ð¿Ð¾Ð´Ñ…Ð¾Ð´ÑÑ‰ÑƒÑŽ Ð¿Ñ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ñƒ\n"
                "â€¢ Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ ÑÐ²Ð¾Ð¹ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚"
            )
            buttons = ['lawyer_consultation', 'free_consultation', 'bankruptcy_calculator']
            
        elif category == 'Ð¾Ñ‚Ñ‡ÐµÑ‚':
            text = (
                "ðŸ“Š **ÐÐ½Ð°Ð»Ð¸Ð· ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð¾Ð³Ð¾ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°**\n\n"
                "ðŸŽ¯ **Ð§Ñ‚Ð¾ Ñ Ð¼Ð¾Ð³Ñƒ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ:**\n\n"
                "ðŸ“‹ **ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°** (Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾)\n"
                "â€¢ Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ñ€Ð¾Ð² Ð¸ ÑÑƒÐ¼Ð¼\n"
                "â€¢ ÐÐ²Ñ‚Ð¾Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¿Ð¸ÑÐµÐ¼ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ñ€Ð°Ð¼\n\n"
                "ðŸ§® **Ð‘Ð°Ð½ÐºÑ€Ð¾Ñ‚Ð½Ñ‹Ð¹ ÐºÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€** (Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾)\n"
                "â€¢ ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ñ‹ Ð±Ð°Ð½ÐºÑ€Ð¾Ñ‚ÑÑ‚Ð²Ð°\n\n"
                "ðŸ“„ **Ð¡Ð¿Ð¸ÑÐ¾Ðº ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ñ€Ð¾Ð² PDF** (Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾)\n"
                "â€¢ Ð“Ð¾Ñ‚Ð¾Ð²Ñ‹Ð¹ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚ Ð´Ð»Ñ ÑÑƒÐ´Ð°"
            )
            buttons = ['check_credit_report', 'bankruptcy_calculator', 'creditors_list']
            
        elif category == 'ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ':
            text = (
                "ðŸ’¬ **ÐÑƒÐ¶Ð½Ð° ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ?**\n\n"
                "ðŸŽ¯ **Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð´Ñ…Ð¾Ð´ÑÑ‰Ð¸Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**\n\n"
                "âš–ï¸ **ÐŸÐµÑ€ÐµÐ¿Ð¸ÑÐºÐ° Ñ ÑŽÑ€Ð¸ÑÑ‚Ð¾Ð¼** (Ð¿Ð»Ð°Ñ‚Ð½Ð¾)\n"
                "â€¢ ÐŸÑ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ 24/7\n"
                "â€¢ Ð¢Ð°Ñ€Ð¸Ñ„Ñ‹: 5000â‚¸ - 15000â‚¸\n\n"
                "ðŸ“… **Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð°Ñ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ**\n"
                "â€¢ Ð–Ð¸Ð²Ð¾Ðµ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ñ Ð°Ð´Ð²Ð¾ÐºÐ°Ñ‚Ð¾Ð¼ ÐœÑƒÑ…Ñ‚Ð°Ñ€Ð¾Ð²Ñ‹Ð¼ Ð¢Ð¾Ñ€ÐµÑ…Ð°Ð½\n"
                "â€¢ ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð¿Ð¾Ð½ÐµÐ´ÐµÐ»ÑŒÐ½Ð¸Ðº Ñ 14:00 Ð´Ð¾ 17:00"
            )
            buttons = ['lawyer_consultation', 'free_consultation']
            
        else:  # Ð¾Ð±Ñ‰ÐµÐµ
            text = (
                "ðŸ¤– **Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ!**\n\n"
                "Ð¯ Ð¿Ð¾Ð¼Ð¾Ð³Ð°ÑŽ Ñ Ð±Ð°Ð½ÐºÑ€Ð¾Ñ‚ÑÑ‚Ð²Ð¾Ð¼ Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð»Ð¸Ñ† Ð² ÐšÐ°Ð·Ð°Ñ…ÑÑ‚Ð°Ð½Ðµ.\n\n"
                "ðŸŽ¯ **ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸:**\n\n"
                "âš–ï¸ **Ð®Ñ€Ð¸Ð´Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ** - Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ð¸\n"
                "ðŸ“Š **ÐÐ½Ð°Ð»Ð¸Ð· ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð¾Ð³Ð¾ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°** - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾Ð»Ð³Ð¾Ð²\n"
                "ðŸ§® **Ð‘Ð°Ð½ÐºÑ€Ð¾Ñ‚Ð½Ñ‹Ð¹ ÐºÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€** - Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ñ‹\n"
                "ðŸ“… **Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð°Ñ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ** - Ñ Ð°Ð´Ð²Ð¾ÐºÐ°Ñ‚Ð¾Ð¼\n\n"
                "ðŸ’¡ Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð½ÑƒÐ¶Ð½ÑƒÑŽ ÑƒÑÐ»ÑƒÐ³Ñƒ:"
            )
            buttons = ['lawyer_consultation', 'check_credit_report', 'bankruptcy_calculator', 'free_consultation']
        
        return text, buttons

    def create_buttons(self, button_types):
        """Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð´Ð»Ñ Ð¾Ñ‚Ð²ÐµÑ‚Ð°"""
        markup = types.InlineKeyboardMarkup(row_width=1)
        
        # ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÐºÐ½Ð¾Ð¿Ð¾Ðº
        button_configs = {
            'lawyer_consultation': ("âš–ï¸ ÐŸÐµÑ€ÐµÐ¿Ð¸ÑÐºÐ° (Ð¿Ð»Ð°Ñ‚Ð½Ð¾) ðŸ’°", "lawyer_consultation"),
            'free_consultation': ("ðŸ“… Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð°Ñ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ ðŸ†“", "free_consultation"),  
            'bankruptcy_calculator': ("ðŸ§® Ð‘Ð°Ð½ÐºÑ€Ð¾Ñ‚Ð½Ñ‹Ð¹ ÐºÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ ðŸ†“", "bankruptcy_calculator"),
            'check_credit_report': ("ðŸ“Š ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ ðŸ†“", "check_credit_report"),
            'creditors_list': ("ðŸ“‹ Ð¡Ð¿Ð¸ÑÐ¾Ðº ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ñ€Ð¾Ð² PDF ðŸ†“", "creditors_list")
        }
        
        # Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð½ÑƒÐ¶Ð½Ñ‹Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸
        for button_type in button_types:
            if button_type in button_configs:
                text, callback = button_configs[button_type]
                markup.add(types.InlineKeyboardButton(text, callback_data=callback))
        
        return markup

    def handle_message(self, message):
        """ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ - Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ"""
        # âœ… Ð”ÐžÐ‘ÐÐ’Ð˜Ð¢Ð¬ Ð­Ð¢Ð£ ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ£:
        ADMIN_IDS = [376068212, 827743984]
        if message.from_user.id in ADMIN_IDS:
            # print(f"[SMART] ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÑŽ Ð°Ð´Ð¼Ð¸Ð½Ð° {message.from_user.id}")
            return  # ÐÐ• ÐžÐ‘Ð ÐÐ‘ÐÐ¢Ð«Ð’ÐÐ•Ðœ Ð¡ÐžÐžÐ‘Ð©Ð•ÐÐ˜Ð¯ ÐžÐ¢ ÐÐ”ÐœÐ˜ÐÐžÐ’
        # 1. ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ
        category = self.analyze_message(message.text)
        
        # 2. Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¾Ñ‚Ð²ÐµÑ‚
        response_text, button_types = self.create_response(category)
        
        # 3. Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÐ¸
        markup = self.create_buttons(button_types)
        
        # 4. ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ñ‚Ð²ÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ
        self.bot.send_message(
            chat_id=message.chat.id,
            text=response_text,
            reply_markup=markup,
            parse_mode='Markdown'
        )
        
        # 5. Ð’Ñ‹Ð²Ð¾Ð´Ð¸Ð¼ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Ð´Ð»Ñ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¸
        print(f"[SMART] ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ {message.from_user.id}: '{message.text[:30]}...' -> {category}")