<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—É–¥–µ–±–Ω—ã–º–∏ –¥–µ–ª–∞–º–∏</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .main-content {
            padding: 30px;
        }

        .section {
            margin-bottom: 40px;
            background: #f8f9ff;
            border-radius: 10px;
            padding: 25px;
            border-left: 5px solid #2196F3;
        }

        .section h2 {
            color: #1976D2;
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: 500;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-right: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }

        .cases-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .cases-table th {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .cases-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            transition: background 0.2s ease;
        }

        .cases-table tr:hover {
            background: #f8f9ff;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
        }

        .status-filed { background: #e3f2fd; color: #1976d2; }
        .status-accepted { background: #e8f5e8; color: #2e7d32; }
        .status-process { background: #fff3e0; color: #f57c00; }
        .status-closed { background: #fce4ec; color: #c2185b; }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-top: 4px solid #2196F3;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            color: #2196F3;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-weight: 500;
        }

        .search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .search-box input {
            padding-left: 45px;
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

        .deadline-alert {
            background: linear-gradient(135deg, #ff5722, #d84315);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .notification-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .cases-table {
                font-size: 14px;
            }
            
            .cases-table th,
            .cases-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öñÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—É–¥–µ–±–Ω—ã–º–∏ –¥–µ–ª–∞–º–∏</h1>
            <p>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è</p>
        </div>

        <div class="main-content">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="section">
                <h2>üìä –°–≤–æ–¥–∫–∞</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalCases">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –¥–µ–ª</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="activeCases">0</div>
                        <div class="stat-label">–í —Ä–∞–±–æ—Ç–µ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="upcomingDeadlines">0</div>
                        <div class="stat-label">–°—Ä–æ–∫–æ–≤ –Ω–∞ –Ω–µ–¥–µ–ª—é</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="todayDeadlines">0</div>
                        <div class="stat-label">–°—Ä–æ—á–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è</div>
                    </div>
                </div>
            </div>

            <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥–µ–ª–∞ -->
            <div class="section">
                <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –¥–µ–ª–æ</h2>
                <form id="newCaseForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="caseNumber">–ù–æ–º–µ—Ä –¥–µ–ª–∞</label>
                            <input type="text" id="caseNumber" required placeholder="–ê40-123456/2025">
                        </div>
                        <div class="form-group">
                            <label for="filingDate">–î–∞—Ç–∞ –ø–æ–¥–∞—á–∏</label>
                            <input type="date" id="filingDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="caseType">–¢–∏–ø –¥–µ–ª–∞</label>
                            <select id="caseType" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                                <option value="–í–∑—ã—Å–∫–∞–Ω–∏–µ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏">–í–∑—ã—Å–∫–∞–Ω–∏–µ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏</option>
                                <option value="–¢—Ä—É–¥–æ–≤–æ–π —Å–ø–æ—Ä">–¢—Ä—É–¥–æ–≤–æ–π —Å–ø–æ—Ä</option>
                                <option value="–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Ä">–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Ä</option>
                                <option value="–ù–∞–ª–æ–≥–æ–≤—ã–π —Å–ø–æ—Ä">–ù–∞–ª–æ–≥–æ–≤—ã–π —Å–ø–æ—Ä</option>
                                <option value="–ë–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ">–ë–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ</option>
                                <option value="–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –¥–µ–ª–æ">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –¥–µ–ª–æ</option>
                                <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="responsible">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</label>
                            <select id="responsible" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ</option>
                                <option value="–ê–¥–≤–æ–∫–∞—Ç">–ê–¥–≤–æ–∫–∞—Ç</option>
                                <option value="–ü–æ–º–æ—â–Ω–∏–∫ 1">–ü–æ–º–æ—â–Ω–∏–∫ 1</option>
                                <option value="–ü–æ–º–æ—â–Ω–∏–∫ 2">–ü–æ–º–æ—â–Ω–∏–∫ 2</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="notes">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                        <textarea id="notes" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–µ–ª–µ"></textarea>
                    </div>
                    <button type="submit" class="btn">–î–æ–±–∞–≤–∏—Ç—å –¥–µ–ª–æ</button>
                </form>
            </div>

            <!-- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
            <div class="section">
                <h2>üîç –ü–æ–∏—Å–∫ –¥–µ–ª</h2>
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É –¥–µ–ª–∞, —Å—É–¥—å–µ, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–º—É...">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="statusFilter">–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É</label>
                        <select id="statusFilter">
                            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="–ü–æ–¥–∞–Ω">–ü–æ–¥–∞–Ω</option>
                            <option value="–ü—Ä–∏–Ω—è—Ç –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É">–ü—Ä–∏–Ω—è—Ç –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É</option>
                            <option value="–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏">–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</option>
                            <option value="–†–µ—à–µ–Ω–∏–µ –≤—ã–Ω–µ—Å–µ–Ω–æ">–†–µ—à–µ–Ω–∏–µ –≤—ã–Ω–µ—Å–µ–Ω–æ</option>
                            <option value="–ó–∞–∫—Ä—ã—Ç–æ">–ó–∞–∫—Ä—ã—Ç–æ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="responsibleFilter">–§–∏–ª—å—Ç—Ä –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–º—É</label>
                        <select id="responsibleFilter">
                            <option value="">–í—Å–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ</option>
                            <option value="–ê–¥–≤–æ–∫–∞—Ç">–ê–¥–≤–æ–∫–∞—Ç</option>
                            <option value="–ü–æ–º–æ—â–Ω–∏–∫ 1">–ü–æ–º–æ—â–Ω–∏–∫ 1</option>
                            <option value="–ü–æ–º–æ—â–Ω–∏–∫ 2">–ü–æ–º–æ—â–Ω–∏–∫ 2</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –¥–µ–ª -->
            <div class="section">
                <h2>üìã –°–ø–∏—Å–æ–∫ –¥–µ–ª</h2>
                <div style="overflow-x: auto;">
                    <table class="cases-table">
                        <thead>
                            <tr>
                                <th>–ù–æ–º–µ—Ä –¥–µ–ª–∞</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–¢–∏–ø</th>
                                <th>–°—É–¥—å—è</th>
                                <th>–°–ª–µ–¥—É—é—â–∏–π —Å—Ä–æ–∫</th>
                                <th>–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="casesTableBody">
                            <!-- –î–µ–ª–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- –≠–∫—Å–ø–æ—Ä—Ç –∏ —É—Ç–∏–ª–∏—Ç—ã -->
            <div class="section">
                <h2>‚öôÔ∏è –£—Ç–∏–ª–∏—Ç—ã</h2>
                <button class="btn btn-success" onclick="exportToCSV()">üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV</button>
                <button class="btn btn-warning" onclick="checkDeadlines()">‚è∞ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ä–æ–∫–∏</button>
                <button class="btn" onclick="generateReport()">üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç</button>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notification" class="notification-panel"></div>

    <script>
        // –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
        let cases = JSON.parse(localStorage.getItem('legalCases') || '[]');

        // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage
        function saveCases() {
            localStorage.setItem('legalCases', JSON.stringify(cases));
            updateStats();
            renderCases();
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.background = type === 'success' ? '#4CAF50' : '#f44336';
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥–µ–ª–∞
        document.getElementById('newCaseForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newCase = {
                id: Date.now(),
                number: document.getElementById('caseNumber').value,
                filingDate: document.getElementById('filingDate').value,
                status: '–ü–æ–¥–∞–Ω',
                type: document.getElementById('caseType').value,
                judge: '',
                nextDate: '',
                responsible: document.getElementById('responsible').value,
                notes: document.getElementById('notes').value,
                lastUpdate: new Date().toISOString()
            };

            cases.push(newCase);
            saveCases();
            
            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            this.reset();
            showNotification(`–î–µ–ª–æ ${newCase.number} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!`);
        });

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–µ–ª
        function renderCases(filteredCases = null) {
            const tbody = document.getElementById('casesTableBody');
            const casesToRender = filteredCases || cases;
            
            tbody.innerHTML = '';
            
            casesToRender.forEach(case_ => {
                const row = document.createElement('tr');
                
                const statusClass = {
                    '–ü–æ–¥–∞–Ω': 'status-filed',
                    '–ü—Ä–∏–Ω—è—Ç –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É': 'status-accepted',
                    '–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏': 'status-process',
                    '–†–µ—à–µ–Ω–∏–µ –≤—ã–Ω–µ—Å–µ–Ω–æ': 'status-closed',
                    '–ó–∞–∫—Ä—ã—Ç–æ': 'status-closed'
                }[case_.status] || 'status-filed';

                row.innerHTML = `
                    <td><strong>${case_.number}</strong></td>
                    <td><span class="status-badge ${statusClass}">${case_.status}</span></td>
                    <td>${case_.type}</td>
                    <td>${case_.judge || '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω'}</td>
                    <td>${case_.nextDate || '–ù–µ —É–∫–∞–∑–∞–Ω'}</td>
                    <td>${case_.responsible}</td>
                    <td>
                        <button class="btn" style="padding: 5px 10px; font-size: 12px;" onclick="editCase(${case_.id})">–ò–∑–º–µ–Ω–∏—Ç—å</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–ª–∞
        function editCase(id) {
            const case_ = cases.find(c => c.id === id);
            if (!case_) return;

            const newStatus = prompt('–ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å:', case_.status);
            const newJudge = prompt('–°—É–¥—å—è:', case_.judge);
            const newNextDate = prompt('–î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è (YYYY-MM-DD):', case_.nextDate);

            if (newStatus !== null) {
                case_.status = newStatus;
                case_.judge = newJudge || case_.judge;
                case_.nextDate = newNextDate || case_.nextDate;
                case_.lastUpdate = new Date().toISOString();
                
                saveCases();
                showNotification(`–î–µ–ª–æ ${case_.number} –æ–±–Ω–æ–≤–ª–µ–Ω–æ!`);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            document.getElementById('totalCases').textContent = cases.length;
            
            const activeCases = cases.filter(c => !['–ó–∞–∫—Ä—ã—Ç–æ', '–†–µ—à–µ–Ω–∏–µ –≤—ã–Ω–µ—Å–µ–Ω–æ'].includes(c.status));
            document.getElementById('activeCases').textContent = activeCases.length;

            const today = new Date();
            const weekLater = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);
            
            const upcomingDeadlines = cases.filter(c => {
                if (!c.nextDate) return false;
                const deadline = new Date(c.nextDate);
                return deadline >= today && deadline <= weekLater;
            });
            
            document.getElementById('upcomingDeadlines').textContent = upcomingDeadlines.length;

            const todayDeadlines = cases.filter(c => {
                if (!c.nextDate) return false;
                const deadline = new Date(c.nextDate);
                return deadline.toDateString() === today.toDateString();
            });
            
            document.getElementById('todayDeadlines').textContent = todayDeadlines.length;
        }

        // –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
        function setupFilters() {
            const searchInput = document.getElementById('searchInput');
            const statusFilter = document.getElementById('statusFilter');
            const responsibleFilter = document.getElementById('responsibleFilter');

            function applyFilters() {
                let filtered = cases;

                const searchTerm = searchInput.value.toLowerCase();
                if (searchTerm) {
                    filtered = filtered.filter(c => 
                        c.number.toLowerCase().includes(searchTerm) ||
                        c.judge.toLowerCase().includes(searchTerm) ||
                        c.responsible.toLowerCase().includes(searchTerm) ||
                        c.type.toLowerCase().includes(searchTerm)
                    );
                }

                if (statusFilter.value) {
                    filtered = filtered.filter(c => c.status === statusFilter.value);
                }

                if (responsibleFilter.value) {
                    filtered = filtered.filter(c => c.responsible === responsibleFilter.value);
                }

                renderCases(filtered);
            }

            searchInput.addEventListener('input', applyFilters);
            statusFilter.addEventListener('change', applyFilters);
            responsibleFilter.addEventListener('change', applyFilters);
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
        function exportToCSV() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "–ù–æ–º–µ—Ä –¥–µ–ª–∞,–î–∞—Ç–∞ –ø–æ–¥–∞—á–∏,–°—Ç–∞—Ç—É—Å,–¢–∏–ø,–°—É–¥—å—è,–°–ª–µ–¥—É—é—â–∏–π —Å—Ä–æ–∫,–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π,–ü—Ä–∏–º–µ—á–∞–Ω–∏—è\n"
                + cases.map(c => 
                    `"${c.number}","${c.filingDate}","${c.status}","${c.type}","${c.judge}","${c.nextDate}","${c.responsible}","${c.notes}"`
                ).join("\n");

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `legal_cases_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ CSV!');
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–æ–≤
        function checkDeadlines() {
            const today = new Date();
            const tomorrow = new Date(today.getTime() + 24 * 60 * 60 * 1000);
            
            const urgentCases = cases.filter(c => {
                if (!c.nextDate) return false;
                const deadline = new Date(c.nextDate);
                return deadline <= tomorrow;
            });

            if (urgentCases.length > 0) {
                let message = `‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï! –°—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞:\n\n`;
                urgentCases.forEach(c => {
                    message += `üìã ${c.number} - ${c.nextDate}\n`;
                });
                alert(message);
            } else {
                showNotification('–°—Ä–æ—á–Ω—ã—Ö –¥–µ–ª –Ω–∞ –∑–∞–≤—Ç—Ä–∞ –Ω–µ—Ç!');
            }
        }

        // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
        function generateReport() {
            const report = {
                totalCases: cases.length,
                byStatus: {},
                byResponsible: {},
                upcomingDeadlines: 0
            };

            cases.forEach(c => {
                report.byStatus[c.status] = (report.byStatus[c.status] || 0) + 1;
                report.byResponsible[c.responsible] = (report.byResponsible[c.responsible] || 0) + 1;
                
                if (c.nextDate) {
                    const deadline = new Date(c.nextDate);
                    const weekLater = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);
                    if (deadline <= weekLater) {
                        report.upcomingDeadlines++;
                    }
                }
            });

            let reportText = `üìä –û–¢–ß–ï–¢ –ü–û –°–£–î–ï–ë–ù–´–ú –î–ï–õ–ê–ú\n`;
            reportText += `–î–∞—Ç–∞: ${new Date().toLocaleDateString()}\n\n`;
            reportText += `üìã –í—Å–µ–≥–æ –¥–µ–ª: ${report.totalCases}\n\n`;
            reportText += `üìä –ü–æ —Å—Ç–∞—Ç—É—Å–∞–º:\n`;
            
            Object.entries(report.byStatus).forEach(([status, count]) => {
                reportText += `‚Ä¢ ${status}: ${count}\n`;
            });
            
            reportText += `\nüë• –ü–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º:\n`;
            Object.entries(report.byResponsible).forEach(([person, count]) => {
                reportText += `‚Ä¢ ${person}: ${count}\n`;
            });
            
            reportText += `\n‚è∞ –°—Ä–æ–∫–æ–≤ –Ω–∞ –Ω–µ–¥–µ–ª—é: ${report.upcomingDeadlines}`;

            alert(reportText);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π –¥–∞—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            document.getElementById('filingDate').value = new Date().toISOString().split('T')[0];
            
            updateStats();
            renderCases();
            setupFilters();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            setTimeout(checkDeadlines, 1000);
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>